"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault"),_regenerator=_interopRequireDefault(require("@babel/runtime/regenerator")),_asyncToGenerator2=_interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));require("@babel/polyfill");var through=require("through2"),gutil=require("gulp-util"),sharp=require("sharp"),PluginError=gutil.PluginError,PLUGIN_NAME="gulp-images-convert";function imagesConvert(r){if(!r)throw new PluginError(PLUGIN_NAME,"Missing option!");var u=r.targetType,a=r.quality;if(!u)throw new PluginError(PLUGIN_NAME,"Missing targetType");return through.obj(function(){var n=(0,_asyncToGenerator2.default)(_regenerator.default.mark(function r(e,t,n){var i;return _regenerator.default.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(e.isStream())return this.emit("error",new PluginError(PLUGIN_NAME,"Streams are not supported")),r.abrupt("return",n());r.next=3;break;case 3:if(e.isBuffer())return r.next=6,sharp(e.contents).toFormat(u,a?{quality:a}:void 0).toBuffer();r.next=10;break;case 6:i=r.sent,e.contents=i,this.push(e),n();case 10:case"end":return r.stop()}},r,this)}));return function(r,e,t){return n.apply(this,arguments)}}())}module.exports=imagesConvert;